
using Asp.Versioning.ApiExplorer;

using Microsoft.Extensions.Options;
using Microsoft.OpenApi.Models;

using Swashbuckle.AspNetCore.SwaggerGen;

using Mod3ASPNET.Filters;



namespace Mod3ASPNET.Doc;

public class ConfigureSwaggerGenOptions : IConfigureOptions<SwaggerGenOptions>
{
     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                 Fields                                                                           !
     //                                                                                                                                                  !
     // ==================================================================================================================================================
     private readonly IApiVersionDescriptionProvider _provider;





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                Constants                                                                         !
     //                                                                                                                                                  !
     // ==================================================================================================================================================





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                Properties                                                                        !
     //                                                                                                                                                  !
     // ==================================================================================================================================================





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                  Indexers                                                                        !
     //                                                                                                                                                  !
     // ==================================================================================================================================================





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                   Events                                                                         !
     //                                                                                                                                                  !
     // ==================================================================================================================================================





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                 Constructors                                                                     !
     //                                                                                                                                                  !
     // ==================================================================================================================================================
     public ConfigureSwaggerGenOptions(IApiVersionDescriptionProvider p_provider)
     {
          _provider = p_provider;
     }





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                              Synchronous methods                                                                 !
     //                                                                                                                                                  !
     // ==================================================================================================================================================
     //public void Configure(SwaggerGenOptions options)
     //{
     //     foreach (var item in _provider.ApiVersionDescriptions)
     //     {
     //          var info = new OpenApiInfo
     //          {
     //               Title     = "Mon API ",
     //               Description = "Documentation de mon API avec Swagger",
     //               Contact   = new OpenApiContact
     //               {
     //                    Name = "Jean-Charles P.",
     //                    Email = "bin@bin.com"
     //               },
     //               Version   = item.ApiVersion.ToString()
     //               //Version = item.GroupName                        // Si nous souhaitons utiliser une autre nom que v1, v2 dans notre nom de groupe, il est nécessaire d'utiliser item.GroupName pour la version
     //          };
     //          options.SwaggerDoc(item.GroupName, info);
     //     }
     //}
     public void Configure(SwaggerGenOptions options)
     {
          foreach (var description in _provider.ApiVersionDescriptions)
          {
               options.SwaggerDoc(description.GroupName, new OpenApiInfo()
                                                            {
                                                                 Title = $"Mon API {description.ApiVersion}",
                                                                 Description = "Documentation de mon API avec Swagger",
                                                                 Contact = new OpenApiContact
                                                                                {
                                                                                     Name = "Jean-Charles P.",
                                                                                     Email = "bin@bin.com"
                                                                                },
                                                                 Version = description.ApiVersion.ToString()
               });
          }
     }





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                             Asynchronous methods                                                                 !
     //                                                                                                                                                  !
     // ==================================================================================================================================================





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                         Standard operators redefined                                                             !
     //                                                                                                                                                  !
     // ==================================================================================================================================================
     // Unary operators ----------------------------------------------------------------------------------------------------------------------------------



     // Binary operators ---------------------------------------------------------------------------------------------------------------------------------



     // Conversion operators -----------------------------------------------------------------------------------------------------------------------------





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                           Standard methods redefined                                                             !
     //                                                                                                                                                  !
     // ==================================================================================================================================================
     // ToString() ---------------------------------------------------------------------------------------------------------------------------------------



     // Equals() -----------------------------------------------------------------------------------------------------------------------------------------



     // HashCode() ---------------------------------------------------------------------------------------------------------------------------------------





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                  Nested types                                                                    !
     //                                                                                                                                                  !
     // ==================================================================================================================================================





     // ==================================================================================================================================================
     //                                                                                                                                                  !
     //                                                                    Finalizer                                                                     !
     //                                                                                                                                                  !
     // ==================================================================================================================================================
     // Unmanaged resources ------------------------------------------------------------------------------------------------------------------------------
}
